@using MultiShop.WebUI.Dtos.CatalogDtos.ProductImageDtos
@model ProductImageSliderDto
<!--Product Image Slider View Component-->

<div class="col-lg-5 mb-30">
    @if (Model.HasImages)
    {
        <div id="product-carousel" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner bg-light">
                @for (int i = 0; i < Model.ImageUrls.Count; i++)
                {
                    <div class="carousel-item @(i == 0 ? "active" : "")">
                        <img class="w-100 h-100" src="@Model.ImageUrls[i]" alt="Product Image" style="object-fit: cover; height: 400px;">
                    </div>
                }
            </div>
            
            @if (Model.TotalImageCount > 1)
            {
                <a class="carousel-control-prev" href="#product-carousel" data-slide="prev">
                    <i class="fa fa-2x fa-angle-left text-dark"></i>
                </a>
                <a class="carousel-control-next" href="#product-carousel" data-slide="next">
                    <i class="fa fa-2x fa-angle-right text-dark"></i>
                </a>
                
                <!-- Carousel Indicators -->
                <ol class="carousel-indicators">
                    @for (int i = 0; i < Model.ImageUrls.Count; i++)
                    {
                        <li data-target="#product-carousel" data-slide-to="@i" class="@(i == 0 ? "active" : "")"></li>
                    }
                </ol>
            }
        </div>
        
        <!-- Thumbnail Images -->
        @if (Model.TotalImageCount > 1)
        {
            <div class="mt-3">
                <div class="row">
                    @for (int i = 0; i < Math.Min(Model.ImageUrls.Count, 4); i++)
                    {
                        <div class="col-3">
                            <img src="@Model.ImageUrls[i]" 
                                 alt="Thumbnail @(i + 1)" 
                                 class="img-fluid thumbnail-image @(i == 0 ? "active-thumbnail" : "")" 
                                 style="cursor: pointer; border: 2px solid @(i == 0 ? "#FFD333" : "transparent"); border-radius: 4px; height: 80px; object-fit: cover;"
                                 onclick="goToSlide(@i)">
                        </div>
                    }
                    @if (Model.TotalImageCount > 4)
                    {
                        <div class="col-3 d-flex align-items-center justify-content-center">
                            <span class="text-muted small">+@(Model.TotalImageCount - 4) more</span>
                        </div>
                    }
                </div>
            </div>
        }
    }
    else
    {
        <!-- Fallback görsel -->
        <div class="bg-light d-flex align-items-center justify-content-center" style="height: 400px; border-radius: 4px;">
            <div class="text-center text-muted">
                <i class="fa fa-image fa-3x mb-3"></i>
                <p>No Image Available</p>
            </div>
        </div>
    }
</div>

<script>
    function goToSlide(slideIndex) {
        $('#product-carousel').carousel(slideIndex);
        
        // Update thumbnail borders
        document.querySelectorAll('.thumbnail-image').forEach((img, index) => {
            img.style.border = index === slideIndex ? '2px solid #FFD333' : '2px solid transparent';
            if (index === slideIndex) {
                img.classList.add('active-thumbnail');
            } else {
                img.classList.remove('active-thumbnail');
            }
        });
    }
    
    // Update thumbnail when carousel changes
    $('#product-carousel').on('slid.bs.carousel', function (e) {
        const activeIndex = $(e.relatedTarget).index();
        document.querySelectorAll('.thumbnail-image').forEach((img, index) => {
            img.style.border = index === activeIndex ? '2px solid #FFD333' : '2px solid transparent';
            if (index === activeIndex) {
                img.classList.add('active-thumbnail');
            } else {
                img.classList.remove('active-thumbnail');
            }
        });
    });
</script>

<style>
    .thumbnail-image:hover {
        border: 2px solid #FFD333 !important;
        transform: scale(1.05);
        transition: all 0.2s ease;
    }
    
    .active-thumbnail {
        transform: scale(1.02);
    }
    
    .carousel-indicators {
        bottom: -50px;
    }
    
    .carousel-indicators li {
        background-color: #ddd;
    }
    
    .carousel-indicators .active {
        background-color: #FFD333;
    }
</style>