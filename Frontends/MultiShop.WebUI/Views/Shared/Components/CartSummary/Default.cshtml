@using MultiShop.WebUI.Dtos.BasketDtos
@model BasketTotalDto
<!--Cart Summary View Components-->

<div class="col-lg-4">
	<form class="mb-30" asp-controller="Discount" asp-action="ConfirmDiscountCode" method="post">
		<div class="input-group">
			<input type="text" name="code" value="@Model?.DiscountCode" class="form-control border-0 p-4" placeholder="Coupon Code">
			<div class="input-group-append">
				<button class="btn btn-primary">Apply Coupon</button>
			</div>
		</div>
		@if (TempData["ErrorMessage"] != null)
		{
			<div class="text-danger mt-2">@TempData["ErrorMessage"]</div>
		}
		@if (TempData["SuccessMessage"] != null)
		{
			<div class="text-success mt-2">@TempData["SuccessMessage"]</div>
		}
	</form>
	<h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3">Cart Summary</span></h5>
	<div class="bg-light p-30 mb-5">
		<div class="border-bottom pb-2">
			<div class="d-flex justify-content-between mb-3">
				<h6>Subtotal</h6>
				<h6 data-subtotal>$@Model?.TotalPrice.ToString("F2")</h6>
			</div>
			<div class="d-flex justify-content-between">
				<h6 class="font-weight-medium">Discount</h6>
				<h6 class="font-weight-medium" data-discount>@((Model?.DiscountRate ?? 0) > 0 ? ($"%{Model.DiscountRate}") : "-")</h6>
			</div>
		</div>
		<div class="pt-2">
			<div class="d-flex justify-content-between mt-2">
				<h5>Total</h5>
				@{
					var rate = Model?.DiscountRate ?? 0;
					var subtotal = Model?.TotalPrice ?? 0;
					var discounted = rate > 0 ? subtotal * (100 - rate) / 100 : subtotal;
				}
				<h5 data-total>$@discounted.ToString("F2")</h5>
			</div>
			<button class="btn btn-block btn-primary font-weight-bold my-3 py-3">Proceed To Checkout</button>
		</div>
	</div>
</div>